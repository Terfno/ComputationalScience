# 15 計算科学レポート
<div style="text-align:center;">3-C-17 末田 貴一</div>

## 与えられた微分方程式をルンゲ・クッタ４次公式によって解くプログラムを作れ．
### (1)
$\frac{dy}{dx}=x+y$ を解く

runge-kutta.cpp
```
#include <stdio.h>

double f(double x, double y){
    return (x + y);
}

int main(){
    int i;
    double x, y, h, k1, k2, k3, k4, k;
    char zz;

    printf("\n\n4次のルンゲクッタ法により dy/dx=x+y を解きます。\n\n");
    printf("Returnキーを押してください。\n");
    scanf("%c",&zz);

    printf("  x          y\n");

    x = 0.0;
    y = 1.0;
    h = 0.1; //刻み幅は0.1

    printf("%10.6lf %10.6lf\n",x,y);

    for(i=1;i<=40;i++){
        k1 = h * f(x, y);
        k2 = h * f(x + (h / 2), y + (k1 / 2));
        k3 = h * f(x + (h / 2) , y + (k2 / 2));
        k4 = h * f(x + h, y + k3);
        k = (k1 + (2 * k2) + (2 * k3) + k4) / 6;
        x = x + h;
        y = y + k;
        
        printf("%10.6lf %10.6lf\n",x,y);
    }
    return 0;
}

```

実行結果
```
$ ./runge-kutta


4次のルンゲクッタ法により dy/dx=x+y を解きます。

Returnキーを押してください。

  x          y
  0.000000   1.000000
  0.100000   1.110342
  0.200000   1.242805
  0.300000   1.399717
  0.400000   1.583648
  0.500000   1.797441
  0.600000   2.044236
  0.700000   2.327503
  0.800000   2.651079
  0.900000   3.019203
  1.000000   3.436559
  1.100000   3.908327
  1.200000   4.440228
  1.300000   5.038586
  1.400000   5.710391
  1.500000   6.463368
  1.600000   7.306053
  1.700000   8.247881
  1.800000   9.299278
  1.900000  10.471769
  2.000000  11.778090
  2.100000  13.232314
  2.200000  14.849997
  2.300000  16.648330
  2.400000  18.646312
  2.500000  20.864941
  2.600000  23.327422
  2.700000  26.059402
  2.800000  29.089223
  2.900000  32.448210
  3.000000  36.170981
  3.100000  40.295797
  3.200000  44.864940
  3.300000  49.925141
  3.400000  55.528044
  3.500000  61.730726
  3.600000  68.596267
  3.700000  76.194379
  3.800000  84.602108
  3.900000  93.904603
  4.000000 104.195965
```
### (2)
$\frac{dy}{dx}=e^{-\sin x}-y\cos x$ を解く

runge-kutta.cpp
```
#include <stdio.h>
#include <math.h>

double f(double x, double y){
    double e = 2.71828182846;
    return (pow(e, -sin(x)) - y * cos(x));
}

int main(){
    int i;
    double x, y, h, k1, k2, k3, k4, k;
    char zz;

    printf("\n\n4次のルンゲクッタ法により dy/dx=e^{-sin x}-ycos x を解きます。\n\n");
    printf("Returnキーを押してください。\n");
    scanf("%c",&zz);

    printf("  x          y\n");

    x = 0.0;
    y = 1.0;
    h = 0.1; //刻み幅は0.1

    printf("%10.6lf %10.6lf\n",x,y);

    for(i=1;i<=40;i++){
        k1 = h * f(x, y);
        k2 = h * f(x + (h / 2), y + (k1 / 2));
        k3 = h * f(x + (h / 2) , y + (k2 / 2));
        k4 = h * f(x + h, y + k3);
        k = (k1 + (2 * k2) + (2 * k3) + k4) / 6;
        x = x + h;
        y = y + k;
        
        printf("%10.6lf %10.6lf\n",x,y);
    }
    return 0;
}

```

実行結果
```
$ ./runge-kutta


4次のルンゲクッタ法により dy/dx=e^{-sin x}-ycos x を解きます。

Returnキーを押してください。

  x          y
  0.000000   1.000000
  0.100000   0.995487
  0.200000   0.983785
  0.300000   0.967388
  0.400000   0.948431
  0.500000   0.928708
  0.600000   0.909701
  0.700000   0.892624
  0.800000   0.878473
  0.900000   0.868078
  1.000000   0.862152
  1.100000   0.861336
  1.200000   0.866250
  1.300000   0.877525
  1.400000   0.895851
  1.500000   0.922005
  1.600000   0.956894
  1.700000   1.001588
  1.800000   1.057356
  1.900000   1.125706
  2.000000   1.208421
  2.100000   1.307599
  2.200000   1.425687
  2.300000   1.565518
  2.400000   1.730330
  2.500000   1.923777
  2.600000   2.149923
  2.700000   2.413197
  2.800000   2.718315
  2.900000   3.070151
  3.000000   3.473538
  3.100000   3.933012
  3.200000   4.452465
  3.300000   5.034729
  3.400000   5.681098
  3.500000   6.390800
  3.600000   7.160470
  3.700000   7.983664
  3.800000   8.850488
  3.900000   9.747395
  4.000000  10.657237
```

## オイラー法，ルンゲ・クッタ２次公式，ルンゲ・クッタ４次公式の計算結果，ならびに真値（解析解）を比較して見よ．
$\frac{dy}{dx}=x+y$ をそれぞれの方法で解く。

euler.cpp
```
#include <stdio.h>
#include <math.h>

double f(double x, double y){
    return (x + y);
}

int main(){
    int i;
    double x, y, h, k;
    char zz;

    printf("\n\n4次のオイラー法により dy/dx=x+y を解きます。\n\n");
    printf("Returnキーを押してください。\n");
    scanf("%c",&zz);

    printf("  x          y\n");

    x = 0.0;
    y = 1.0;
    h = 0.1; //刻み幅は0.1とする

    printf("%10.6lf %10.6lf\n",x,y);

    for(i=0;i <= 10;i++){
        k = h * f(x, y);
        x = x + h;
        y = y + k;

        printf("%10.6lf %10.6lf\n",x,y);
    }
    return 0;
}

```
runge-kutta-2.cpp
```
#include <stdio.h>

double f(double x, double y){
    return (x + y);
}

int main(){
    int i;
    double x, y, h, k1, k2, k;
    char zz;

    printf("\n\n2次のルンゲクッタ法により dy/dx=x+y を解きます。\n\n");
    printf("Returnキーを押してください。\n");
    scanf("%c",&zz);

    printf("  x          y\n");

    x = 0.0;
    y = 1.0;
    h = 0.1; //刻み幅は0.1

    printf("%10.6lf %10.6lf\n",x,y);

    for(i=1;i<=40;i++){
        k1 = h * f(x, y);
        k2 = h * f(x + h, y + k1);
        k = (k1 + k2) / 2;
        x = x + h;
        y = y + k;
        
        printf("%10.6lf %10.6lf\n",x,y);
    }
    return 0;
}

```
runge-kutta-4.cpp
```
#include <stdio.h>

double f(double x, double y){
    return (x + y);
}

int main(){
    int i;
    double x, y, h, k1, k2, k3, k4, k;
    char zz;

    printf("\n\n4次のルンゲクッタ法により dy/dx=x+y を解きます。\n\n");
    printf("Returnキーを押してください。\n");
    scanf("%c",&zz);

    printf("  x          y\n");

    x = 0.0;
    y = 1.0;
    h = 0.1; //刻み幅は0.1

    printf("%10.6lf %10.6lf\n",x,y);

    for(i=1;i<=40;i++){
        k1 = h * f(x, y);
        k2 = h * f(x + (h / 2), y + (k1 / 2));
        k3 = h * f(x + (h / 2) , y + (k2 / 2));
        k4 = h * f(x + h, y + k3);
        k = (k1 + (2 * k2) + (2 * k3) + k4) / 6;
        x = x + h;
        y = y + k;
        
        printf("%10.6lf %10.6lf\n",x,y);
    }
    return 0;
}

```
いずれも刻み幅0.1
| オイラー法 | 2次のルンゲクッタ法 | 4次のルンゲクッタ法 | 解析解 |
| ---- | ---- | ---- | ---- |
|1.000000|1.000000|1.000000| |
|1.100000|1.110000|1.110342| |
|1.220000|1.242050|1.242805| |
|1.362000|1.398465|1.399717| |
|1.528200|1.581804|1.583648| |
|1.721020|1.794894|1.797441| |
|1.943122|2.040857|2.044236| |
|2.197434|2.323147|2.327503| |
|2.487178|2.645578|2.651079| |
|2.815895|3.012364|3.019203| |
|3.187485|3.428162|3.436559| |
## 刻み幅を変えて結果を比較してみよ．
4次のルンゲクッタ法によって $\frac{dy}{dx}=x+y$ を解く際の刻み幅を変えて比較してみる(いずれもyの値)。

| 0.025 | 0.05 | 0.1 | 0.2 | 0.4 |
| ---- | ---- | ---- | ---- | ---- |
|1.000000|1.000000|1.000000|1.000000| 1.000000|
|0.995487|0.998812|0.999695|0.983783| 0.948380|
|0.983785|0.995487|0.998812|0.948429| 0.878422|
|0.967388|0.990370|0.997394|0.909699| 0.866187|
|0.948431|0.983785|0.995487|0.878471| 0.956809|
|0.928708|0.976032|0.993132|0.862149| 1.208303|
|0.909701|0.967388|0.990370|0.866247| 1.730141|
|0.892624|0.958109|0.987242|0.895847| 2.717908|
|0.878473|0.948431|0.983785|0.956890| 4.451476|
|0.868078|0.938566|0.980036|1.057351| 7.158432|
|0.862152|0.928708|0.976032|1.208415|10.653959|
