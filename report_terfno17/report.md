# 計算科学18
<div style=text-align:center;>3-C-19 Sueda Takahito</div>

## 8.1
次の波動方程式を例題8.1にならって解け

### (1)
$$
\frac{\partial^2z}{\partial t^2}=4\frac{\partial^2z}{\partial x^2}, (0<=x<=1,0<=t)\\
初期条件 z(x,0)=\sin(\pi x),z_t(x, 0)=0\\
境界条件 z(0,t)=0,z(1,t)=0
$$
ソースコード
```cpp
#include <stdio.h>
#include <math.h>

#define M 18
#define N 10
#define FNF(x) sin(3.14 * x);

int main()
{
    int i, j, n;
    double a, b, h, c, k, t, x, z[N + 1][M + 1];
    char zz;

    a = 0.0;
    b = 2.0;
    h = 0.25;
    n = (b - a) / h;
    n = (int)n;
    c = 4.0;
    k = h / sqrt(c);

    for (i = 0; i <= n; i++)
    {
        x = a + h * i;
        z[i][0] = FNF(x);
    }

    for (j = 0; j <= M; j++)
    {
        z[0][j] = 0.0;
        z[n][j] = 0.0;
    }

    for (i = 1; i <= n - 1; i++)
    {
        z[i][1] = (z[i + 1][0] + z[i - 1][0]) / 2.0;
    }

    for (j = 1; j <= M - 1; j++)
    {
        for (i = 1; i <= n - 1; i++)
        {
            z[i][j + 1] = z[i + 1][j] + z[i - 1][j] - z[i][j - 1];
        }
    }

    printf("波動方程式の差分による数値解\n\n波動方程式：Ztt=%1.01lfZxx\n", c);
    printf("\nD        : ");
    printf("%1.0lf<=x<=%1.0lf, 0<=t<=%3.1lf\n", a, b, k * M);
    printf("\n横の刻み    : h=%4.2lf", h);
    printf("\n縦の刻み    : k=%4.2lf", k);
    printf("\n\nエンターキーを押せば計算結果を出力します。\n");
    scanf("%c", &zz);

    for (t = 0.0, j = 0; j <= M; j++)
    {
        for (x = 0.0, i = 0; i <= n; i++)
        {
            printf("%7.4lf", z[i][j]);
        }
        printf("\n");
    }

    for (t = 0.0, j = 0; j <= M; j++)
    {
        for (x = 0.0, i = 0; i <= n; i++)
        {
            printf("%7.4lf %7.4lf %7.4lf\n", x, t, z[i][j]);
            x = x + 0.25;
        }
        printf("\n");
        t = t + 0.25 / 3.0;
    }

    return 0;
}

```
計算結果
```
エンターキーを押せば計算結果を出力します。

 0.0000 0.7068 1.0000 0.7080 0.0016-0.7057-1.0000-0.7091 0.0000
 0.0000 0.5000 0.7074 0.5008 0.0011-0.4992-0.7074-0.5000 0.0000
 0.0000 0.0006 0.0008 0.0006 0.0000-0.0006 0.0008 0.0017 0.0000
 0.0000-0.4992-0.7063-0.5000-0.0011 0.5000 0.7085 0.5008 0.0000
 0.0000-0.7068-1.0000-0.7080 0.0000 0.7080 1.0000 0.7068 0.0000
 0.0000-0.5008-0.7085-0.5000 0.0011 0.5000 0.7063 0.4992 0.0000
 0.0000-0.0017-0.0008 0.0006-0.0000-0.0006-0.0008-0.0006 0.0000
 0.0000 0.5000 0.7074 0.4992-0.0011-0.5008-0.7074-0.5000 0.0000
 0.0000 0.7091 1.0000 0.7057-0.0016-0.7080-1.0000-0.7068 0.0000
 0.0000 0.5000 0.7074 0.4992-0.0011-0.5008-0.7074-0.5000 0.0000
 0.0000-0.0017-0.0008 0.0006-0.0000-0.0006-0.0008-0.0006 0.0000
 0.0000-0.5008-0.7085-0.5000 0.0011 0.5000 0.7063 0.4992 0.0000
 0.0000-0.7068-1.0000-0.7080 0.0000 0.7080 1.0000 0.7068 0.0000
 0.0000-0.4992-0.7063-0.5000-0.0011 0.5000 0.7085 0.5008 0.0000
 0.0000 0.0006 0.0008 0.0006 0.0000-0.0006 0.0008 0.0017 0.0000
 0.0000 0.5000 0.7074 0.5008 0.0011-0.4992-0.7074-0.5000 0.0000
 0.0000 0.7068 1.0000 0.7080 0.0016-0.7057-1.0000-0.7091 0.0000
 0.0000 0.5000 0.7074 0.5008 0.0011-0.4992-0.7074-0.5000 0.0000
 0.0000 0.0006 0.0008 0.0006 0.0000-0.0006 0.0008 0.0017 0.0000
```
### (2)
$$
\frac{\partial^2 z}{\partial t^2}=2\frac{\partial^2 z}{\partial x^2}\\
初期条件 z(x,0)=
\begin{cases}
    0.5x && (0<=x<=2) \\
    -0.5x+2 && (2<=x<=4) \\
\end{cases}\\
境界条件 z(0,t)=0,z(1,t)=0
$$

ソースコード
```cpp
#include <stdio.h>
#include <math.h>

#define M 18
#define N 10
#define FNF(x) 0.5 * x;

int main()
{
    int i, j, n;
    double a, b, h, c, k, t, x, z[N + 1][M + 1];
    char zz;

    a = 0.0;
    b = 2.0;
    h = 0.25;
    n = (b - a) / h;
    n = (int)n;
    c = 2.0;
    k = h / sqrt(c);

    for (i = 0; i <= n; i++)
    {
        x = a + h * i;
        z[i][0] = FNF(x);
    }

    for (j = 0; j <= M; j++)
    {
        z[0][j] = 0.0;
        z[n][j] = 0.0;
    }

    for (i = 1; i <= n - 1; i++)
    {
        z[i][1] = (z[i + 1][0] + z[i - 1][0]) / 2.0;
    }

    for (j = 1; j <= M - 1; j++)
    {
        for (i = 1; i <= n - 1; i++)
        {
            z[i][j + 1] = z[i + 1][j] + z[i - 1][j] - z[i][j - 1];
        }
    }

    printf("波動方程式の差分による数値解\n\n波動方程式：Ztt=%1.01lfZxx\n", c);
    printf("\nD        : ");
    printf("%1.0lf<=x<=%1.0lf, 0<=t<=%3.1lf\n", a, b, k * M);
    printf("\n横の刻み    : h=%4.2lf", h);
    printf("\n縦の刻み    : k=%4.2lf", k);
    printf("\n\nエンターキーを押せば計算結果を出力します。\n");
    scanf("%c", &zz);

    for (t = 0.0, j = 0; j <= M; j++)
    {
        for (x = 0.0, i = 0; i <= n; i++)
        {
            printf("%7.4lf", z[i][j]);
        }
        printf("\n");
    }

    for (t = 0.0, j = 0; j <= M; j++)
    {
        for (x = 0.0, i = 0; i <= n; i++)
        {
            printf("%7.4lf %7.4lf %7.4lf\n", x, t, z[i][j]);
            x = x + 0.25;
        }
        printf("\n");
        t = t + 0.25 / 3.0;
    }

    return 0;
}

```
結果
```
エンターキーを押せば計算結果を出力します。

 0.0000 0.1250 0.2500 0.3750 0.5000 0.6250 0.7500 0.8750 0.0000
 0.0000 0.1250 0.2500 0.3750 0.5000 0.6250 0.7500 0.3750 0.0000
 0.0000 0.1250 0.2500 0.3750 0.5000 0.6250 0.2500-0.1250 0.0000
 0.0000 0.1250 0.2500 0.3750 0.5000 0.1250-0.2500-0.1250 0.0000
 0.0000 0.1250 0.2500 0.3750 0.0000-0.3750-0.2500-0.1250 0.0000
 0.0000 0.1250 0.2500-0.1250-0.5000-0.3750-0.2500-0.1250 0.0000
 0.0000 0.1250-0.2500-0.6250-0.5000-0.3750-0.2500-0.1250 0.0000
 0.0000-0.3750-0.7500-0.6250-0.5000-0.3750-0.2500-0.1250 0.0000
 0.0000-0.8750-0.7500-0.6250-0.5000-0.3750-0.2500-0.1250 0.0000
 0.0000-0.3750-0.7500-0.6250-0.5000-0.3750-0.2500-0.1250 0.0000
 0.0000 0.1250-0.2500-0.6250-0.5000-0.3750-0.2500-0.1250 0.0000
 0.0000 0.1250 0.2500-0.1250-0.5000-0.3750-0.2500-0.1250 0.0000
 0.0000 0.1250 0.2500 0.3750 0.0000-0.3750-0.2500-0.1250 0.0000
 0.0000 0.1250 0.2500 0.3750 0.5000 0.1250-0.2500-0.1250 0.0000
 0.0000 0.1250 0.2500 0.3750 0.5000 0.6250 0.2500-0.1250 0.0000
 0.0000 0.1250 0.2500 0.3750 0.5000 0.6250 0.7500 0.3750 0.0000
 0.0000 0.1250 0.2500 0.3750 0.5000 0.6250 0.7500 0.8750 0.0000
 0.0000 0.1250 0.2500 0.3750 0.5000 0.6250 0.7500 0.3750 0.0000
 0.0000 0.1250 0.2500 0.3750 0.5000 0.6250 0.2500-0.1250 0.0000
```

ソースコード
```cpp
#include <stdio.h>
#include <math.h>

#define M 18
#define N 10
#define FNF(x) 0.5 * x + 2;

int main()
{
    int i, j, n;
    double a, b, h, c, k, t, x, z[N + 1][M + 1];
    char zz;

    a = 2.0;
    b = 4.0;
    h = 0.25;
    n = (b - a) / h;
    n = (int)n;
    c = 2.0;
    k = h / sqrt(c);

    for (i = 0; i <= n; i++)
    {
        x = a + h * i;
        z[i][0] = FNF(x);
    }

    for (j = 0; j <= M; j++)
    {
        z[0][j] = 0.0;
        z[n][j] = 0.0;
    }

    for (i = 1; i <= n - 1; i++)
    {
        z[i][1] = (z[i + 1][0] + z[i - 1][0]) / 2.0;
    }

    for (j = 1; j <= M - 1; j++)
    {
        for (i = 1; i <= n - 1; i++)
        {
            z[i][j + 1] = z[i + 1][j] + z[i - 1][j] - z[i][j - 1];
        }
    }

    printf("波動方程式の差分による数値解\n\n波動方程式：Ztt=%1.01lfZxx\n", c);
    printf("\nD        : ");
    printf("%1.0lf<=x<=%1.0lf, 0<=t<=%3.1lf\n", a, b, k * M);
    printf("\n横の刻み    : h=%4.2lf", h);
    printf("\n縦の刻み    : k=%4.2lf", k);
    printf("\n\nエンターキーを押せば計算結果を出力します。\n");
    scanf("%c", &zz);

    for (t = 0.0, j = 0; j <= M; j++)
    {
        for (x = 0.0, i = 0; i <= n; i++)
        {
            printf("%7.4lf", z[i][j]);
        }
        printf("\n");
    }

    for (t = 0.0, j = 0; j <= M; j++)
    {
        for (x = 0.0, i = 0; i <= n; i++)
        {
            printf("%7.4lf %7.4lf %7.4lf\n", x, t, z[i][j]);
            x = x + 0.25;
        }
        printf("\n");
        t = t + 0.25 / 3.0;
    }

    return 0;
}

```
結果
```
エンターキーを押せば計算結果を出力します。

 0.0000 3.1250 3.2500 3.3750 3.5000 3.6250 3.7500 3.8750 0.0000
 0.0000 1.6250 3.2500 3.3750 3.5000 3.6250 3.7500 1.8750 0.0000
 0.0000 0.1250 1.7500 3.3750 3.5000 3.6250 1.7500-0.1250 0.0000
 0.0000 0.1250 0.2500 1.8750 3.5000 1.6250-0.2500-0.1250 0.0000
 0.0000 0.1250 0.2500 0.3750 0.0000-0.3750-0.2500-0.1250 0.0000
 0.0000 0.1250 0.2500-1.6250-3.5000-1.8750-0.2500-0.1250 0.0000
 0.0000 0.1250-1.7500-3.6250-3.5000-3.3750-1.7500-0.1250 0.0000
 0.0000-1.8750-3.7500-3.6250-3.5000-3.3750-3.2500-1.6250 0.0000
 0.0000-3.8750-3.7500-3.6250-3.5000-3.3750-3.2500-3.1250 0.0000
 0.0000-1.8750-3.7500-3.6250-3.5000-3.3750-3.2500-1.6250 0.0000
 0.0000 0.1250-1.7500-3.6250-3.5000-3.3750-1.7500-0.1250 0.0000
 0.0000 0.1250 0.2500-1.6250-3.5000-1.8750-0.2500-0.1250 0.0000
 0.0000 0.1250 0.2500 0.3750 0.0000-0.3750-0.2500-0.1250 0.0000
 0.0000 0.1250 0.2500 1.8750 3.5000 1.6250-0.2500-0.1250 0.0000
 0.0000 0.1250 1.7500 3.3750 3.5000 3.6250 1.7500-0.1250 0.0000
 0.0000 1.6250 3.2500 3.3750 3.5000 3.6250 3.7500 1.8750 0.0000
 0.0000 3.1250 3.2500 3.3750 3.5000 3.6250 3.7500 3.8750 0.0000
 0.0000 1.6250 3.2500 3.3750 3.5000 3.6250 3.7500 1.8750 0.0000
 0.0000 0.1250 1.7500 3.3750 3.5000 3.6250 1.7500-0.1250 0.0000
```
